<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <script>
      setTimeout(function(){
          window.location.href = 'https://subhodeeps.vercel.app/';
      }, 5);  // Redirects after 5 seconds
  </script>
  
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>The phase portrait of a nonlinear pendulum. - Subhodeep Sarkar</title>
<meta name="description" content="In this post, we will talk about how a solve nonlinear differential equation numerically in python and learn how to plot its phase portrait using the nonlinear pendulum as a model.">


  <meta name="author" content="Subhodeep Sarkar">
  
  <meta property="article:author" content="Subhodeep Sarkar">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Subhodeep Sarkar">
<meta property="og:title" content="The phase portrait of a nonlinear pendulum.">
<meta property="og:url" content="http://localhost:4000/posts/2022/10/nonlinear_dynamics/">


  <meta property="og:description" content="In this post, we will talk about how a solve nonlinear differential equation numerically in python and learn how to plot its phase portrait using the nonlinear pendulum as a model.">







  <meta property="article:published_time" content="2022-10-02T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/posts/2022/10/nonlinear_dynamics/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Subhodeep Sarkar",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="O6bxxdBfloHKnPqzKuT9xzlz1x87pUQAfRG_TdNk_ug" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Subhodeep Sarkar Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>



<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>




    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- Link to Academicon ORDID icon -->
<link rel="stylesheet" href="/assets/css/academicons.css"/>
  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Subhodeep Sarkar
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/cv/">CV</a>
            </li><li class="masthead__menu-item">
              <a href="/publications/">Research</a>
            </li><li class="masthead__menu-item">
              <a href="/teaching/">Teaching</a>
            </li><li class="masthead__menu-item">
              <a href="/books/">My Bookshelf</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Blog</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/avatar.jpg" alt="Subhodeep Sarkar" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Subhodeep Sarkar</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Postdoctoral Researcher, Indian Institute of Technology Madras</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      
        <li>
          <a href="mailto:subhodeep.sarkar1@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="subhodeep.sarkar1@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      
      
      
      <li>
         <a href="https://inspirehep.net/authors/1797180?ui-citation-summary=true&ui-exclude-self-citations=true" ><i class="ai ai-inspire-square ai-fw"></i><span class="label">iNSPIRE</span></a>
      </li>
        

        
        
         <li><a href="https://scholar.google.com/citations?user=WpYbE3oAAAAJ&hl=en"><i class="ai ai-google-scholar-square ai-fw"></i><span class="label">Google Scholar</span></a></a></li>
        
        
        <li><a href="https://www.semanticscholar.org/author/Subhodeep-Sarkar/9729924"><i class="ai ai-semantic-scholar-square ai-fw"></i><span class="label">Semantic Scholar</span></a></a></li>
        
        
        
        <li><a href="https://www.researchgate.net/profile/Subhodeep_Sarkar" itemprop="sameAs" rel="nofollow noopener noreferrer me">
          <i class="ai ai-researchgate-square ai-fw" aria-hidden="true"></i><span class="label">ResearchGate</span></a></a></li>
        
        
        
        
         

      

      
        <li>
          <a href="https://twitter.com/astres_occlus" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/subhodeeps" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!-- 



<li>
   <a href="https://inspirehep.net/authors/1797180?ui-citation-summary=true&ui-exclude-self-citations=true" ><i class="ai ai-inspire-square ai-fw"></i> 
    <span class="label"> iNSPIRE</span></a>
</li>
  

  
  
   <li><a href="https://scholar.google.com/citations?user=WpYbE3oAAAAJ&hl=en"><i class="ai ai-google-scholar-square ai-fw"></i> <span class="label"> Google Scholar</span></a></a></li>
  
  
  <li><a href="https://www.semanticscholar.org/author/Subhodeep-Sarkar/9729924"><i class="ai ai-semantic-scholar-square ai-fw"></i> <span class="label"> Semantic Scholar</span></a></a></li>
  
  
  
  <li><a href="https://www.researchgate.net/profile/Subhodeep_Sarkar" itemprop="sameAs" rel="nofollow noopener noreferrer me">
    <i class="ai ai-researchgate-square ai-fw" aria-hidden="true"></i> <span class="label"> ResearchGate</span></a></a></li>
  
  
   --> 
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="The phase portrait of a nonlinear pendulum.">
    <meta itemprop="description" content="In this post, we will talk about how a solve nonlinear differential equation numerically in python and learn how to plot its phase portrait using the nonlinear pendulum as a model.">
    <meta itemprop="datePublished" content="2022-10-02T00:00:00+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/posts/2022/10/nonlinear_dynamics/" class="u-url" itemprop="url">The phase portrait of a nonlinear pendulum.
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h2 id="draft-version-using-this-as-an-excuse-to-test-the-blog">DRAFT VERSION: Using this as an excuse to test the blog!</h2>

<p>The motion of a nonlinear pendulum is governed by the well known equation,</p>

\[\begin{align}
\dfrac{d^2 x}{d t^2} + \sin x = 0 .
\end{align}\]

<p>The above equation is an example of a second-order, nonlinear ordinary differential equation (ODE). We can now introduce the following coordinate,</p>

\[\begin{align}
y &amp; = \dfrac{d x}{d t},
\end{align}\]

<p>and converted the second order ODE into a system to two first order ODEs, viz.,</p>

\[\begin{align}
\dot{x} &amp; = y, \\
\dot{y} &amp; = - \sin x.
\end{align}\]

<p>Here, dot denotes a derivative with respect to time.</p>

<p>We can now introduce a vector \(\vec{S} = x \hat{i} + y \hat{j},\)</p>

<p>and write our $2D$ system as,</p>

\[\begin{align}
\dfrac{d \vec{S}}{d t} =
\begin{bmatrix}
S_2 \\
-\sin S_1
\end{bmatrix}=
\begin{bmatrix}
y \\
-\sin x
\end{bmatrix},
\end{align}\]

<p>where $S_i$ is the $i$-th component of $\vec{S}$.</p>

<p>Our task is to analyse the behaviour of this system, and we do that by</p>

<ul>
  <li>drawing the phase portrait of the system,</li>
  <li>solving the system of ODEs numerically.</li>
</ul>

<p>We shall use python to perfrom the above tasks. We begin by importing suitable python libraries,</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">numpy</code> to perform manipulations over numeric arrays</li>
  <li><code class="language-plaintext highlighter-rouge">scipy.integrate.solve_ivp</code> to numerically solve our ODEs</li>
  <li><code class="language-plaintext highlighter-rouge">matplotlib</code> to plot the results</li>
  <li><code class="language-plaintext highlighter-rouge">seaborn</code> to make the graphs look pretty.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span>
<span class="p">.</span><span class="nf">set_style</span><span class="p">(</span><span class="s">"darkgrid"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Our first task is to code up a function that returns the right hand side (RHS) of the system.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">S</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Notice that</p>

<ul>
  <li>our function takes two arguments $S$ and $t$.</li>
  <li>although our system is autonomous (that is, the RHS is independent of time), we still include the independent variable, this is because our ODE solvers are designed to accept functions which depend on both the variables.
    <ul>
      <li>the order of the arguments in the function signature is important, <code class="language-plaintext highlighter-rouge">solve_ivp</code> expects the independent variable first.</li>
      <li>moreover, we set $t$ to take a default value $(0)$, so that can avoid passing a superficial argument while plotting the functions; we keep the $t$ to ensure we can use the same function for numerically solving the ODEs and for plotting the phase portrait.</li>
    </ul>
  </li>
</ul>

<p>Our first order of business is to generate the phase portrait: we have to essentially sketch the vector field</p>

\[\begin{align}
\dot{\vec{S}} &amp; = \dot{x} ~ \hat{i} ~ + ~ \dot{y} ~ \hat{j},\\
        &amp; = y ~ \hat{i} ~ - ~ \sin x \hat{j}.
\end{align}\]

<p>To plot a vector field, we need the following two functions:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">numpy.meshgrid</code> to generate a grid of points (over the 2D plane) where we must calculate the value of the components of the vector field.</li>
  <li><code class="language-plaintext highlighter-rouge">matplotlib.pyplt.streamplot</code> to visualize a vector field by plotting the streamlines of the vector flow.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">XX</span> <span class="p">,</span> <span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span> <span class="o">=</span> <span class="nf">f</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/images/nonlinearpendulum/output_6_0.png" alt="png" /></p>

<p>In the above code block, we,</p>

<ul>
  <li>first set up the figure and axes object (if this looks unfamiliar, <a href="https://stackoverflow.com/a/34162641">check this out</a></li>
  <li>we then set appropriate ranges for the variables, $x$ and $y$.</li>
  <li>we use <code class="language-plaintext highlighter-rouge">numpy.linspace</code> to generate 30 points along the $x$ and $y$ axes each.</li>
  <li>we then use <code class="language-plaintext highlighter-rouge">numpy.meshgrid</code> to obtain two 2D arrays $XX$ and $YY$ that helps us in computing the vector field over the entire $x-y$ plane.</li>
  <li>we store the values of the components of the vector field in <code class="language-plaintext highlighter-rouge">xdot</code> and <code class="language-plaintext highlighter-rouge">ydot</code>.</li>
  <li>finally we use <code class="language-plaintext highlighter-rouge">matplotlib.pyplot.streamplot</code> to sketch the vector field.</li>
</ul>

<p>The primary purpose of using <code class="language-plaintext highlighter-rouge">meshgrid</code> is to avoid using slow python loops. To get a better understanding of how <code class="language-plaintext highlighter-rouge">meshgrid</code> works, <a href="https://stackoverflow.com/questions/36013063/what-is-the-purpose-of-meshgrid-in-python-numpy">check this out</a>.</p>

<p>Notice the line where <code class="language-plaintext highlighter-rouge">streamplot</code> is invoked. The basic syntax is:</p>

<p><code class="language-plaintext highlighter-rouge">ax.streamplot(x_grid,y_grid,x_vec,y_vec, density=spacing)</code></p>

<p>Here <code class="language-plaintext highlighter-rouge">x_grid</code> and <code class="language-plaintext highlighter-rouge">y_grid</code> are arrays of <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> points. The arrays <code class="language-plaintext highlighter-rouge">x_vec</code> and <code class="language-plaintext highlighter-rouge">y_vec</code> denote the stream velocity at each point on the grid. The keyword argument <code class="language-plaintext highlighter-rouge">density=spacing</code> specifies how close the streamlines are drawn together.</p>

<p>We shall now use <code class="language-plaintext highlighter-rouge">odeint</code> to numerically solve the $2D$ system.</p>

<p>Since, we have two differntial equations, we have to provide two initial conditions. First, shall try to simulate the case where the bob of the pendulum is initially at rest, and it is set into motion with some initial velocity, that is,</p>

<p>\(x(0) = 0, ~ y(0) = c,\)
where $c$ is a constant.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">45.0</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">'r-'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/images/nonlinearpendulum/output_9_0.png" alt="png" /></p>

<p>In the above code block, we:</p>

<ul>
  <li>first set up the figure and axes object</li>
  <li>set up the time interval over which we solve our ODEs</li>
  <li>provide the first initial condition, $x(0)=0$</li>
  <li>we then construct an array containing suitable values of $c$ which we shall use to provide the second initial condition</li>
  <li>we then run a loop that picks up one element after the other from the array containg $c$ and calls the ODE solver with the initial conditions $[0,c]$</li>
  <li>the solution is stored in ys and then plotted.</li>
</ul>

<p>We have used <code class="language-plaintext highlighter-rouge">odeint</code> to solve our ODEs; the syntax is
<code class="language-plaintext highlighter-rouge">ys= odeint(model, initial_values, t)</code> where</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">model</code> is the RHS of the 2D system</li>
  <li><code class="language-plaintext highlighter-rouge">initial values</code> is an array containing the initial conditions</li>
  <li><code class="language-plaintext highlighter-rouge">t</code> is an array containing the point on the time axis where the ODEs are solved</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">odeint</code> returns a matrix which has $k$ columns, one for each of the $k$ variables, and a row for each time point specified in <code class="language-plaintext highlighter-rouge">t</code>.</p>

<p>Lastly, I will change some attributes of <code class="language-plaintext highlighter-rouge">seaborn</code> to change the colour of the plots and define a helper function to plot arrows along the trajectories on the phase space. The detailed working of this function is not important.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">#define seaborn background colors
</span><span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s">'axes.facecolor'</span><span class="p">:</span> <span class="s">'#252a34'</span><span class="p">,</span><span class="s">'figure.facecolor'</span><span class="p">:</span><span class="s">'#252a34'</span><span class="p">})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">plotarrows</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nf">int</span><span class="p">((</span><span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">:].</span><span class="nf">flatten</span><span class="p">()</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">ys</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">:].</span><span class="nf">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="p">.</span><span class="nf">arrow</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
                  <span class="n">shape</span><span class="o">=</span><span class="s">'full'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="p">.</span><span class="mi">06</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We now put everything together.</p>

<ul>
  <li>we sketch the vector field field (that is, draw the phase portrait)</li>
  <li>we solve the ODEs with the initial conditions
    <ul>
      <li>$x(0)= 5 \pi, y(0)= c ~ \mathrm{where} ~ c \in [-2, -1]$</li>
      <li>$x(0)= -5 \pi, y(0)= c ~ \mathrm{where} ~ c \in [1, 2]$</li>
      <li>$x(0)= 0 \pi, y(0)= c ~ \mathrm{where} ~ c \in (-2, 2)$</li>
      <li>and then plot everything</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">XX</span> <span class="p">,</span> <span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span> <span class="o">=</span> <span class="nf">f</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#52adc8'</span><span class="p">)</span>


<span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">45.0</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mf">5.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>



<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.95</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

<span class="c1"># uncomment for grid lines but no labels
# ax.set(yticklabels=[]) # hide y labels
# ax.set(xticklabels=[]) # hide x labels
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="s">"header.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/images/nonlinearpendulum/output_15_0.png" alt="png" /></p>

<h3 id="references">References:</h3>

<p>[1] Nonlinear Dynamics and Chaos, 2nd Ed by Steven Strogatz, CRC Press (2015).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#classical-mechanics" class="page__taxonomy-item p-category" rel="tag">classical mechanics</a><span class="sep">, </span>
    
      <a href="/tags/#nonlinear-dynamics" class="page__taxonomy-item p-category" rel="tag">nonlinear dynamics</a><span class="sep">, </span>
    
      <a href="/tags/#phase-portrait" class="page__taxonomy-item p-category" rel="tag">phase portrait</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Published:</strong> <time class="dt-published" datetime="2022-10-02T00:00:00+05:30">October 2, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=The+phase+portrait+of+a+nonlinear+pendulum.%20http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022%2F10%2Fnonlinear_dynamics%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022%2F10%2Fnonlinear_dynamics%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022%2F10%2Fnonlinear_dynamics%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You May Also Enjoy</h2>
      <div class="grid__wrapper">
        
          
            
      </div>
    </div>
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        
<div class="page__footer-quote"><p><q>Perfection of character is this: to live each day as if it were your last, without frenzy, without apathy, without pretence.</q><br> ~ Marcus Aurelius, Meditations (7:69) </p></div>
<div class="page__footer-copyright">&copy; 2025 Subhodeep Sarkar. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<!-- Mathjax scripts -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<!-- Bootsrap & MDB scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@/dist/js/bootstrap.bundle.min.js" integrity="" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@/js/mdb.min.js" integrity="" crossorigin="anonymous"></script>

<!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@/dist/jquery.min.js" integrity="" crossorigin="anonymous"></script>



  <script src="/assets/js/main.min.js"></script>











  </body>

  
</html>
